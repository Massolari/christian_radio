(function(p,c){typeof exports=="object"&&typeof module<"u"?c(exports):typeof define=="function"&&define.amd?define(["exports"],c):(p=typeof globalThis<"u"?globalThis:p||self,c(p.client={}))})(this,function(p){"use strict";var Fe=(p,c,b)=>{if(!c.has(p))throw TypeError("Cannot "+b)};var d=(p,c,b)=>(Fe(p,c,"read from private field"),b?b.call(p):c.get(p)),k=(p,c,b)=>{if(c.has(p))throw TypeError("Cannot add the same private member more than once");c instanceof WeakSet?c.add(p):c.set(p,b)},h=(p,c,b,v)=>(Fe(p,c,"write to private field"),v?v.call(p,b):c.set(p,b),b);var U=(p,c,b)=>(Fe(p,c,"access private method"),b);var W,T,D,L,B,J,R,V,C,G,pe,ne,qe,he,at,de,ft;class c{withFields(t){let n=Object.keys(this).map(r=>r in t?t[r]:this[r]);return new this.constructor(...n)}}class b{static fromArray(t,n){let r=n||new De;for(let s=t.length-1;s>=0;--s)r=new Be(t[s],r);return r}[Symbol.iterator](){return new ct(this)}toArray(){return[...this]}atLeastLength(t){for(let n of this){if(t<=0)return!0;t--}return t<=0}hasLength(t){for(let n of this){if(t<=0)return!1;t--}return t===0}countLength(){let t=0;for(let n of this)t++;return t}}function v(e,t){return new Be(e,t)}function o(e,t){return b.fromArray(e,t)}class ct{constructor(t){k(this,W,void 0);h(this,W,t)}next(){if(d(this,W)instanceof De)return{done:!0};{let{head:t,tail:n}=d(this,W);return h(this,W,n),{value:t,done:!1}}}}W=new WeakMap;class De extends b{}class Be extends b{constructor(t,n){super(),this.head=t,this.tail=n}}class se{constructor(t){if(!(t instanceof Uint8Array))throw"BitArray can only be constructed from a Uint8Array";this.buffer=t}get length(){return this.buffer.length}byteAt(t){return this.buffer[t]}floatFromSlice(t,n,r){return ht(this.buffer,t,n,r)}intFromSlice(t,n,r,s){return lt(this.buffer,t,n,r,s)}binaryFromSlice(t,n){return new se(this.buffer.slice(t,n))}sliceAfter(t){return new se(this.buffer.slice(t))}}class ot{constructor(t){this.value=t}}function lt(e,t,n,r,s){let i=0;if(r)for(let u=t;u<n;u++)i=i*256+e[u];else for(let u=n-1;u>=t;u--)i=i*256+e[u];if(s){const a=2**((n-t)*8-1);i>=a&&(i-=a*2)}return i}function ht(e,t,n,r){const s=new DataView(e.buffer),i=n-t;if(i===8)return s.getFloat64(t,!r);if(i===4)return s.getFloat32(t,!r);{const u=`Sized floats must be 32-bit or 64-bit on JavaScript, got size of ${i*8} bits`;throw new globalThis.Error(u)}}class ie extends c{static isResult(t){return t instanceof ie}}class ye extends ie{constructor(t){super(),this[0]=t}isOk(){return!0}}class we extends ie{constructor(t){super(),this[0]=t}isOk(){return!1}}function I(e,t){let n=[e,t];for(;n.length;){let r=n.pop(),s=n.pop();if(r===s)continue;if(!Re(r)||!Re(s)||!xt(r,s)||pt(r,s)||yt(r,s)||wt(r,s)||bt(r,s)||mt(r,s)||gt(r,s))return!1;const u=Object.getPrototypeOf(r);if(u!==null&&typeof u.equals=="function")try{if(r.equals(s))continue;return!1}catch{}let[a,l]=dt(r);for(let f of a(r))n.push(l(r,f),l(s,f))}return!0}function dt(e){if(e instanceof Map)return[t=>t.keys(),(t,n)=>t.get(n)];{let t=e instanceof globalThis.Error?["message"]:[];return[n=>[...t,...Object.keys(n)],(n,r)=>n[r]]}}function pt(e,t){return e instanceof Date&&(e>t||e<t)}function yt(e,t){return e.buffer instanceof ArrayBuffer&&e.BYTES_PER_ELEMENT&&!(e.byteLength===t.byteLength&&e.every((n,r)=>n===t[r]))}function wt(e,t){return Array.isArray(e)&&e.length!==t.length}function bt(e,t){return e instanceof Map&&e.size!==t.size}function mt(e,t){return e instanceof Set&&(e.size!=t.size||[...e].some(n=>!t.has(n)))}function gt(e,t){return e instanceof RegExp&&(e.source!==t.source||e.flags!==t.flags)}function Re(e){return typeof e=="object"&&e!==null}function xt(e,t){return typeof e!="object"&&typeof t!="object"&&(!e||!t)||[Promise,WeakSet,WeakMap,Function].some(r=>e instanceof r)?!1:e.constructor===t.constructor}function At(e,t,n,r,s,i){let u=new globalThis.Error(s);u.gleam_error=e,u.module=t,u.line=n,u.fn=r;for(let a in i)u[a]=i[a];return u}class He extends c{constructor(t){super(),this[0]=t}}class Ue extends c{}function St(e,t){for(;;){let n=e,r=t;if(n.hasLength(0))return r;{let s=n.head;e=n.tail,t=v(s,r)}}}function kt(e){return St(e,o([]))}function Et(e,t){for(;;){let n=e,r=t;if(n.hasLength(0))return!1;if(n.atLeastLength(1)&&I(n.head,r))return n.head,!0;e=n.tail,t=r}}function _t(e,t){for(;;){let n=e,r=t;if(n.hasLength(0))return r;{let s=n.head;e=n.tail,t=v(s,r)}}}function Nt(e,t){for(;;){let n=e,r=t;if(n.hasLength(0))return kt(r);{let s=n.head;e=n.tail,t=_t(s,r)}}}function Ot(e){return Nt(e,o([]))}function jt(e){return e}const Pe=new WeakMap,be=new DataView(new ArrayBuffer(8));let me=0;function ge(e){const t=Pe.get(e);if(t!==void 0)return t;const n=me++;return me===2147483647&&(me=0),Pe.set(e,n),n}function xe(e,t){return e^t+2654435769+(e<<6)+(e>>2)|0}function Ae(e){let t=0;const n=e.length;for(let r=0;r<n;r++)t=Math.imul(31,t)+e.charCodeAt(r)|0;return t}function We(e){be.setFloat64(0,e);const t=be.getInt32(0),n=be.getInt32(4);return Math.imul(73244475,t>>16^t)^n}function zt(e){return Ae(e.toString())}function Tt(e){const t=Object.getPrototypeOf(e);if(t!==null&&typeof t.hashCode=="function")try{const r=e.hashCode(e);if(typeof r=="number")return r}catch{}if(e instanceof Promise||e instanceof WeakSet||e instanceof WeakMap)return ge(e);if(e instanceof Date)return We(e.getTime());let n=0;if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),Array.isArray(e)||e instanceof Uint8Array)for(let r=0;r<e.length;r++)n=Math.imul(31,n)+N(e[r])|0;else if(e instanceof Set)e.forEach(r=>{n=n+N(r)|0});else if(e instanceof Map)e.forEach((r,s)=>{n=n+xe(N(r),N(s))|0});else{const r=Object.keys(e);for(let s=0;s<r.length;s++){const i=r[s],u=e[i];n=n+xe(N(u),Ae(i))|0}}return n}function N(e){if(e===null)return 1108378658;if(e===void 0)return 1108378659;if(e===!0)return 1108378657;if(e===!1)return 1108378656;switch(typeof e){case"number":return We(e);case"string":return Ae(e);case"bigint":return zt(e);case"object":return Tt(e);case"symbol":return ge(e);case"function":return ge(e);default:return 0}}const $=5,Se=Math.pow(2,$),$t=Se-1,Mt=Se/2,Lt=Se/4,g=0,M=1,E=2,P=3,ke={type:E,bitmap:0,array:[]};function Z(e,t){return e>>>t&$t}function ue(e,t){return 1<<Z(e,t)}function It(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),e=e+(e>>4)&252645135,e+=e>>8,e+=e>>16,e&127}function Ee(e,t){return It(e&t-1)}function O(e,t,n){const r=e.length,s=new Array(r);for(let i=0;i<r;++i)s[i]=e[i];return s[t]=n,s}function Ft(e,t,n){const r=e.length,s=new Array(r+1);let i=0,u=0;for(;i<t;)s[u++]=e[i++];for(s[u++]=n;i<r;)s[u++]=e[i++];return s}function _e(e,t){const n=e.length,r=new Array(n-1);let s=0,i=0;for(;s<t;)r[i++]=e[s++];for(++s;s<n;)r[i++]=e[s++];return r}function Ce(e,t,n,r,s,i){const u=N(t);if(u===r)return{type:P,hash:u,array:[{type:g,k:t,v:n},{type:g,k:s,v:i}]};const a={val:!1};return Q(Ne(ke,e,u,t,n,a),e,r,s,i,a)}function Q(e,t,n,r,s,i){switch(e.type){case M:return qt(e,t,n,r,s,i);case E:return Ne(e,t,n,r,s,i);case P:return Dt(e,t,n,r,s,i)}}function qt(e,t,n,r,s,i){const u=Z(n,t),a=e.array[u];if(a===void 0)return i.val=!0,{type:M,size:e.size+1,array:O(e.array,u,{type:g,k:r,v:s})};if(a.type===g)return I(r,a.k)?s===a.v?e:{type:M,size:e.size,array:O(e.array,u,{type:g,k:r,v:s})}:(i.val=!0,{type:M,size:e.size,array:O(e.array,u,Ce(t+$,a.k,a.v,n,r,s))});const l=Q(a,t+$,n,r,s,i);return l===a?e:{type:M,size:e.size,array:O(e.array,u,l)}}function Ne(e,t,n,r,s,i){const u=ue(n,t),a=Ee(e.bitmap,u);if(e.bitmap&u){const l=e.array[a];if(l.type!==g){const y=Q(l,t+$,n,r,s,i);return y===l?e:{type:E,bitmap:e.bitmap,array:O(e.array,a,y)}}const f=l.k;return I(r,f)?s===l.v?e:{type:E,bitmap:e.bitmap,array:O(e.array,a,{type:g,k:r,v:s})}:(i.val=!0,{type:E,bitmap:e.bitmap,array:O(e.array,a,Ce(t+$,f,l.v,n,r,s))})}else{const l=e.array.length;if(l>=Mt){const f=new Array(32),y=Z(n,t);f[y]=Ne(ke,t+$,n,r,s,i);let A=0,_=e.bitmap;for(let S=0;S<32;S++){if(_&1){const re=e.array[A++];f[S]=re}_=_>>>1}return{type:M,size:l+1,array:f}}else{const f=Ft(e.array,a,{type:g,k:r,v:s});return i.val=!0,{type:E,bitmap:e.bitmap|u,array:f}}}}function Dt(e,t,n,r,s,i){if(n===e.hash){const u=Oe(e,r);if(u!==-1)return e.array[u].v===s?e:{type:P,hash:n,array:O(e.array,u,{type:g,k:r,v:s})};const a=e.array.length;return i.val=!0,{type:P,hash:n,array:O(e.array,a,{type:g,k:r,v:s})}}return Q({type:E,bitmap:ue(e.hash,t),array:[e]},t,n,r,s,i)}function Oe(e,t){const n=e.array.length;for(let r=0;r<n;r++)if(I(t,e.array[r].k))return r;return-1}function ae(e,t,n,r){switch(e.type){case M:return Bt(e,t,n,r);case E:return Rt(e,t,n,r);case P:return Ht(e,r)}}function Bt(e,t,n,r){const s=Z(n,t),i=e.array[s];if(i!==void 0){if(i.type!==g)return ae(i,t+$,n,r);if(I(r,i.k))return i}}function Rt(e,t,n,r){const s=ue(n,t);if(!(e.bitmap&s))return;const i=Ee(e.bitmap,s),u=e.array[i];if(u.type!==g)return ae(u,t+$,n,r);if(I(r,u.k))return u}function Ht(e,t){const n=Oe(e,t);if(!(n<0))return e.array[n]}function je(e,t,n,r){switch(e.type){case M:return Ut(e,t,n,r);case E:return Pt(e,t,n,r);case P:return Wt(e,r)}}function Ut(e,t,n,r){const s=Z(n,t),i=e.array[s];if(i===void 0)return e;let u;if(i.type===g){if(!I(i.k,r))return e}else if(u=je(i,t+$,n,r),u===i)return e;if(u===void 0){if(e.size<=Lt){const a=e.array,l=new Array(e.size-1);let f=0,y=0,A=0;for(;f<s;){const _=a[f];_!==void 0&&(l[y]=_,A|=1<<f,++y),++f}for(++f;f<a.length;){const _=a[f];_!==void 0&&(l[y]=_,A|=1<<f,++y),++f}return{type:E,bitmap:A,array:l}}return{type:M,size:e.size-1,array:O(e.array,s,u)}}return{type:M,size:e.size,array:O(e.array,s,u)}}function Pt(e,t,n,r){const s=ue(n,t);if(!(e.bitmap&s))return e;const i=Ee(e.bitmap,s),u=e.array[i];if(u.type!==g){const a=je(u,t+$,n,r);return a===u?e:a!==void 0?{type:E,bitmap:e.bitmap,array:O(e.array,i,a)}:e.bitmap===s?void 0:{type:E,bitmap:e.bitmap^s,array:_e(e.array,i)}}return I(r,u.k)?e.bitmap===s?void 0:{type:E,bitmap:e.bitmap^s,array:_e(e.array,i)}:e}function Wt(e,t){const n=Oe(e,t);if(n<0)return e;if(e.array.length!==1)return{type:P,hash:e.hash,array:_e(e.array,n)}}function ve(e,t){if(e===void 0)return;const n=e.array,r=n.length;for(let s=0;s<r;s++){const i=n[s];if(i!==void 0){if(i.type===g){t(i.v,i.k);continue}ve(i,t)}}}class F{static fromObject(t){const n=Object.keys(t);let r=F.new();for(let s=0;s<n.length;s++){const i=n[s];r=r.set(i,t[i])}return r}static fromMap(t){let n=F.new();return t.forEach((r,s)=>{n=n.set(s,r)}),n}static new(){return new F(void 0,0)}constructor(t,n){this.root=t,this.size=n}get(t,n){if(this.root===void 0)return n;const r=ae(this.root,0,N(t),t);return r===void 0?n:r.v}set(t,n){const r={val:!1},s=this.root===void 0?ke:this.root,i=Q(s,0,N(t),t,n,r);return i===this.root?this:new F(i,r.val?this.size+1:this.size)}delete(t){if(this.root===void 0)return this;const n=je(this.root,0,N(t),t);return n===this.root?this:n===void 0?F.new():new F(n,this.size-1)}has(t){return this.root===void 0?!1:ae(this.root,0,N(t),t)!==void 0}entries(){if(this.root===void 0)return[];const t=[];return this.forEach((n,r)=>t.push([r,n])),t}forEach(t){ve(this.root,t)}hashCode(){let t=0;return this.forEach((n,r)=>{t=t+xe(N(n),N(r))|0}),t}equals(t){if(!(t instanceof F)||this.size!==t.size)return!1;let n=!0;return this.forEach((r,s)=>{n=n&&I(t.get(s,!r),r)}),n}}function Fn(e){return e}function q(e){const t=typeof e;if(e===!0)return"True";if(e===!1)return"False";if(e===null)return"//js(null)";if(e===void 0)return"Nil";if(t==="string")return Ct(e);if(t==="bigint"||t==="number")return e.toString();if(Array.isArray(e))return`#(${e.map(q).join(", ")})`;if(e instanceof b)return Xt(e);if(e instanceof ot)return Vt(e);if(e instanceof se)return Jt(e);if(e instanceof c)return Yt(e);if(e instanceof F)return vt(e);if(e instanceof Set)return`//js(Set(${[...e].map(q).join(", ")}))`;if(e instanceof RegExp)return`//js(${e})`;if(e instanceof Date)return`//js(Date("${e.toISOString()}"))`;if(e instanceof Function){const n=[];for(const r of Array(e.length).keys())n.push(String.fromCharCode(r+97));return`//fn(${n.join(", ")}) { ... }`}return Kt(e)}function Ct(e){let t='"';for(let n=0;n<e.length;n++){let r=e[n];switch(r){case`
`:t+="\\n";break;case"\r":t+="\\r";break;case"	":t+="\\t";break;case"\f":t+="\\f";break;case"\\":t+="\\\\";break;case'"':t+='\\"';break;default:r<" "||r>"~"&&r<" "?t+="\\u{"+r.charCodeAt(0).toString(16).toUpperCase().padStart(4,"0")+"}":t+=r}}return t+='"',t}function vt(e){let t="dict.from_list([",n=!0;return e.forEach((r,s)=>{n||(t=t+", "),t=t+"#("+q(s)+", "+q(r)+")",n=!1}),t+"])"}function Kt(e){var i,u;const t=((u=(i=Object.getPrototypeOf(e))==null?void 0:i.constructor)==null?void 0:u.name)||"Object",n=[];for(const a of Object.keys(e))n.push(`${q(a)}: ${q(e[a])}`);const r=n.length?" "+n.join(", ")+" ":"";return`//js(${t==="Object"?"":t+" "}{${r}})`}function Yt(e){const t=Object.keys(e).map(n=>{const r=q(e[n]);return isNaN(parseInt(n))?`${n}: ${r}`:r}).join(", ");return t?`${e.constructor.name}(${t})`:e.constructor.name}function Xt(e){return`[${e.toArray().map(q).join(", ")}]`}function Jt(e){return`<<${Array.from(e.buffer).join(", ")}>>`}function Vt(e){return`//utfcodepoint(${String.fromCodePoint(e.value)})`}function Gt(e){let t=q(e);return jt(t)}function Zt(e,t,n){return e?t:n()}class Qt extends c{constructor(t){super(),this.all=t}}function Ke(){return new Qt(o([]))}class en extends c{constructor(t){super(),this.content=t}}class x extends c{constructor(t,n,r,s,i,u,a){super(),this.key=t,this.namespace=n,this.tag=r,this.attrs=s,this.children=i,this.self_closing=u,this.void=a}}class Ye extends c{constructor(t,n,r){super(),this[0]=t,this[1]=n,this.as_property=r}}function tn(e,t){return new Ye(e,t,!1)}function nn(e,t){return new Ye(e,t,!0)}function z(e){return tn("class",e)}function rn(e){return nn("disabled",e)}function fe(e,t,n){return e==="area"?new x("","",e,t,o([]),!1,!0):e==="base"?new x("","",e,t,o([]),!1,!0):e==="br"?new x("","",e,t,o([]),!1,!0):e==="col"?new x("","",e,t,o([]),!1,!0):e==="embed"?new x("","",e,t,o([]),!1,!0):e==="hr"?new x("","",e,t,o([]),!1,!0):e==="img"?new x("","",e,t,o([]),!1,!0):e==="input"?new x("","",e,t,o([]),!1,!0):e==="link"?new x("","",e,t,o([]),!1,!0):e==="meta"?new x("","",e,t,o([]),!1,!0):e==="param"?new x("","",e,t,o([]),!1,!0):e==="source"?new x("","",e,t,o([]),!1,!0):e==="track"?new x("","",e,t,o([]),!1,!0):e==="wbr"?new x("","",e,t,o([]),!1,!0):new x("","",e,t,n,!1,!1)}function K(e){return new en(e)}class sn extends c{constructor(t){super(),this[0]=t}}class ce extends c{constructor(t){super(),this[0]=t}}class un extends c{}class an extends c{constructor(t){super(),this[0]=t}}function Xe(e,t,n,r=!1){let s,i=[{prev:e,next:t,parent:e.parentNode}];for(;i.length;){let{prev:u,next:a,parent:l}=i.pop();if(a.subtree!==void 0&&(a=a.subtree()),a.content!==void 0)if(u)if(u.nodeType===Node.TEXT_NODE)u.textContent!==a.content&&(u.textContent=a.content),s??(s=u);else{const f=document.createTextNode(a.content);l.replaceChild(f,u),s??(s=f)}else{const f=document.createTextNode(a.content);l.appendChild(f),s??(s=f)}else if(a.tag!==void 0){const f=fn({prev:u,next:a,dispatch:n,stack:i,isComponent:r});u?u!==f&&l.replaceChild(f,u):l.appendChild(f),s??(s=f)}else a.elements!==void 0?Y(a,f=>{i.unshift({prev:u,next:f,parent:l}),u=u==null?void 0:u.nextSibling}):a.subtree!==void 0&&i.push({prev:u,next:a,parent:l})}return s}function fn({prev:e,next:t,dispatch:n,stack:r}){const s=t.namespace||"http://www.w3.org/1999/xhtml",i=e&&e.nodeType===Node.ELEMENT_NODE&&e.localName===t.tag&&e.namespaceURI===(t.namespace||"http://www.w3.org/1999/xhtml"),u=i?e:s?document.createElementNS(s,t.tag):document.createElement(t.tag);let a;if(ee.has(u))a=ee.get(u);else{const m=new Map;ee.set(u,m),a=m}const l=i?new Set(a.keys()):null,f=i?new Set(Array.from(e.attributes,m=>m.name)):null;let y=null,A=null,_=null;for(const m of t.attrs){const w=m[0],j=m[1];if(m.as_property)u[w]!==j&&(u[w]=j),i&&f.delete(w);else if(w.startsWith("on")){const H=w.slice(2),Ie=n(j);a.has(H)||u.addEventListener(H,te),a.set(H,Ie),i&&l.delete(H)}else if(w.startsWith("data-lustre-on-")){const H=w.slice(15),Ie=n(cn);a.has(H)||u.addEventListener(H,te),a.set(H,Ie),u.setAttribute(w,j)}else w==="class"?y=y===null?j:y+" "+j:w==="style"?A=A===null?j:A+j:w==="dangerous-unescaped-html"?_=j:(u.getAttribute(w)!==j&&u.setAttribute(w,j),(w==="value"||w==="selected")&&(u[w]=j),i&&f.delete(w))}if(y!==null&&(u.setAttribute("class",y),i&&f.delete("class")),A!==null&&(u.setAttribute("style",A),i&&f.delete("style")),i){for(const m of f)u.removeAttribute(m);for(const m of l)a.delete(m),u.removeEventListener(m,te)}if(t.key!==void 0&&t.key!=="")u.setAttribute("data-lustre-key",t.key);else if(_!==null)return u.innerHTML=_,u;let S=u.firstChild,re=null,it=null,ut=null,Le=t.children[Symbol.iterator]().next().value;i&&Le!==void 0&&Le.key!==void 0&&Le.key!==""&&(re=new Set,it=Je(e),ut=Je(t));for(const m of t.children)Y(m,w=>{w.key!==void 0&&re!==null?S=on(S,w,u,r,ut,it,re):(r.unshift({prev:S,next:w,parent:u}),S=S==null?void 0:S.nextSibling)});for(;S;){const m=S.nextSibling;u.removeChild(S),S=m}return u}const ee=new WeakMap;function te(e){const t=e.currentTarget;if(!ee.has(t)){t.removeEventListener(e.type,te);return}const n=ee.get(t);if(!n.has(e.type)){t.removeEventListener(e.type,te);return}n.get(e.type)(e)}function cn(e){const t=e.currentTarget,n=t.getAttribute(`data-lustre-on-${e.type}`),r=JSON.parse(t.getAttribute("data-lustre-data")||"{}"),s=JSON.parse(t.getAttribute("data-lustre-include")||"[]");switch(e.type){case"input":case"change":s.push("target.value");break}return{tag:n,data:s.reduce((i,u)=>{var l;const a=u.split(".");for(let f=0,y=i,A=e;f<a.length;f++)f===a.length-1?y[a[f]]=A[a[f]]:(y[l=a[f]]??(y[l]={}),A=A[a[f]],y=y[a[f]]);return i},{data:r})}}function Je(e){const t=new Map;if(e)for(const n of e.children)Y(n,r=>{var i;const s=(r==null?void 0:r.key)||((i=r==null?void 0:r.getAttribute)==null?void 0:i.call(r,"data-lustre-key"));s&&t.set(s,r)});return t}function on(e,t,n,r,s,i,u){for(;e&&!s.has(e.getAttribute("data-lustre-key"));){const l=e.nextSibling;n.removeChild(e),e=l}if(i.size===0)return Y(t,l=>{r.unshift({prev:e,next:l,parent:n}),e=e==null?void 0:e.nextSibling}),e;if(u.has(t.key))return console.warn(`Duplicate key found in Lustre vnode: ${t.key}`),r.unshift({prev:null,next:t,parent:n}),e;u.add(t.key);const a=i.get(t.key);if(!a&&!e)return r.unshift({prev:null,next:t,parent:n}),e;if(!a&&e!==null){const l=document.createTextNode("");return n.insertBefore(l,e),r.unshift({prev:l,next:t,parent:n}),e}return!a||a===e?(r.unshift({prev:e,next:t,parent:n}),e=e==null?void 0:e.nextSibling,e):(n.insertBefore(a,e),r.unshift({prev:a,next:t,parent:n}),e)}function Y(e,t){if(e.elements!==void 0)for(const n of e.elements)Y(n,t);else e.subtree!==void 0?Y(e.subtree(),t):t(e)}const Me=class Me{constructor([t,n],r,s,i=document.body,u=!1){k(this,G);k(this,ne);k(this,he);k(this,de);k(this,T,null);k(this,D,[]);k(this,L,[]);k(this,B,!1);k(this,J,!1);k(this,R,null);k(this,V,null);k(this,C,null);h(this,R,t),h(this,V,r),h(this,C,s),h(this,T,i),h(this,L,n.all.toArray()),h(this,B,!0),h(this,J,u),window.requestAnimationFrame(()=>U(this,G,pe).call(this))}static start(t,n,r,s,i){if(!Ve())return new we(new Ge);const u=n instanceof HTMLElement?n:document.querySelector(n);if(!u)return new we(new dn(n));const a=new Me(r(t),s,i,u);return new ye(l=>a.send(l))}send(t){switch(!0){case t instanceof ce:{d(this,D).push(t[0]),U(this,G,pe).call(this);return}case t instanceof un:{U(this,de,ft).call(this);return}case t instanceof sn:{U(this,he,at).call(this,t[0]);return}default:return}}emit(t,n){d(this,T).dispatchEvent(new CustomEvent(t,{bubbles:!0,detail:n,composed:!0}))}};T=new WeakMap,D=new WeakMap,L=new WeakMap,B=new WeakMap,J=new WeakMap,R=new WeakMap,V=new WeakMap,C=new WeakMap,G=new WeakSet,pe=function(){if(U(this,ne,qe).call(this),d(this,B)){const t=d(this,C).call(this,d(this,R)),n=r=>s=>{const i=r(s);i instanceof ye&&this.send(new ce(i[0]))};h(this,B,!1),h(this,T,Xe(d(this,T),t,n,d(this,J)))}},ne=new WeakSet,qe=function(t=0){for(;d(this,D).length;){const[n,r]=d(this,V).call(this,d(this,R),d(this,D).shift());d(this,B)||h(this,B,d(this,R)!==n),h(this,R,n),h(this,L,d(this,L).concat(r.all.toArray()))}for(;d(this,L).length;)d(this,L).shift()(n=>this.send(new ce(n)),(n,r)=>this.emit(n,r));d(this,D).length&&(t<5?U(this,ne,qe).call(this,++t):window.requestAnimationFrame(()=>U(this,G,pe).call(this)))},he=new WeakSet,at=function(t){switch(!0){case t instanceof an:{const n=d(this,C).call(this,t[0]),r=s=>i=>{const u=s(i);u instanceof ye&&this.send(new ce(u[0]))};h(this,D,[]),h(this,L,[]),h(this,B,!1),h(this,T,Xe(d(this,T),n,r,d(this,J)))}}},de=new WeakSet,ft=function(){d(this,T).remove(),h(this,T,null),h(this,R,null),h(this,D,[]),h(this,L,[]),h(this,B,!1),h(this,V,()=>{}),h(this,C,()=>{})};let ze=Me;const ln=(e,t,n)=>ze.start(n,t,e.init,e.update,e.view),Ve=()=>globalThis.window&&window.document;class hn extends c{constructor(t,n,r,s){super(),this.init=t,this.update=n,this.view=r,this.on_attribute_change=s}}class dn extends c{constructor(t){super(),this.selector=t}}class Ge extends c{}function pn(e,t,n){return new hn(e,t,n,new Ue)}function yn(e,t,n){return Zt(!Ve(),new we(new Ge),()=>ln(e,t,n))}function wn(e,t){return fe("main",e,t)}function X(e,t){return fe("div",e,t)}function Te(e,t){return fe("span",e,t)}function Ze(e,t){return fe("button",e,t)}class oe extends c{}class $e extends c{}class Qe extends c{constructor(t){super(),this[0]=t}}class le extends c{constructor(t){super(),this[0]=t}}function bn(e,t){if(e instanceof oe)return new oe;if(e instanceof $e)return new $e;if(e instanceof Qe){let n=e[0];return new Qe(n)}else{let n=e[0];return new le(t(n))}}function mn(e,t){return e instanceof le?e[0]:t}function gn(e){if(e instanceof le){let t=e[0];return new He(t)}else return new Ue}class xn extends c{constructor(t,n){super(),this.title=t,this.artist=n}}class An extends c{}class Sn extends c{}class et extends c{}class tt extends c{}class kn extends c{}class En extends c{}class nt extends c{}function _n(e){return e instanceof An?"data_saver_off":e instanceof Sn?"error":e instanceof et?"favorite":e instanceof tt?"favorite_border":e instanceof kn?"heart_broken":e instanceof En?"music_off":e instanceof nt?"play_arrow":"sync_problem"}function rt(e,t){let n=_n(t);return Te(v(z("material-icons"),e),o([K(n)]))}function st(e){return X(o([z("flex flex-col gap-1")]),o([Te(o([z("text-dark-shades text-lg font-medium")]),o([K(e.title)])),Te(o([z("text-dark-accent text-sm italic")]),o([K(e.artist)]))]))}function Nn(e,t){let n=gn(e);if(n instanceof He){let r=n[0];return Ze(o([]),o([rt(o([z("text-3xl")]),Et(t,r)?new et:new tt)]))}else return K("")}function On(e){return Ze(Ot(o([(()=>{let n=bn(e,r=>o([]));return mn(n,o([z("opacity-50"),rn(!0)]))})(),o([z("flex items-center gap-2")])])),o([rt(o([z("text-4xl")]),new nt)]))}function jn(e,t){return X(o([z("absolute w-full bottom-2 px-1 h-20")]),o([X(o([z("w-full h-full bg-light-shades rounded-lg flex justify-between px-5 py-3 items-center")]),o([(()=>{if(e instanceof oe)return X(o([]),o([K("Nenhuma estação selecionada")]));if(e instanceof $e)return X(o([]),o([K("Carregando...")]));if(e instanceof le){let n=e[0];return st(n)}else{let n=e[0];return st(new xn("Erro ao carregar música",Gt(n)))}})(),X(o([]),o([Nn(e,t),On(e)]))]))]))}class zn extends c{constructor(t,n,r,s){super(),this.tab=t,this.song=n,this.history=r,this.favorites=s}}class Tn extends c{}function $n(e){return[new zn(new Tn,new oe,o([]),o([])),Ke()]}function Mn(e,t){{let n=t.tab;return[e.withFields({tab:n}),Ke()]}}function Ln(e){return wn(o([z("bg-main-brand flex flex-col gap-8 pt-6 h-screen")]),o([jn(e.song,e.favorites)]))}function In(){let e=pn($n,Mn,Ln),t=yn(e,"#app",void 0);if(!t.isOk())throw At("assignment_no_match","client",257,"main","Assignment pattern did not match",{value:t})}p.main=In,Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})});
